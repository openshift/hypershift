tests:
- as: verify
  commands: make verify
  container:
    from: src
  skip_if_only_changed: (^(\.tekton|\.github|docs|examples|enhancements|contrib)/)|(^[A-Z]+\.md$)|((^|/)OWNERS$)|(/overrides\.yaml$)|(/\.testcoverage\.yml$)
- as: e2e-aws
  capabilities:
  - build-tmpfs
  skip_if_only_changed: (^(\.tekton|\.github|docs|examples|enhancements|contrib)/)|(^[A-Z]+\.md$)|((^|/)OWNERS$)|(/overrides\.yaml$)|(/\.testcoverage\.yml$)
  steps:
    cluster_profile: hypershift
    dependencies:
      OCP_IMAGE_N1: release:n1minor
      OCP_IMAGE_N2: release:n2minor
    env:
      ENABLE_HYPERSHIFT_CERT_ROTATION_SCALE: "true"
      REQUEST_SERVING_COMPONENT_TEST: "true"
    workflow: hypershift-aws-e2e-external
- as: e2e-aws-upgrade
  capabilities:
  - build-tmpfs
  skip_if_only_changed: (^(\.tekton|\.github|docs|examples|enhancements|contrib)/)|(^[A-Z]+\.md$)|((^|/)OWNERS$)|(/overrides\.yaml$)|(/\.testcoverage\.yml$)
  steps:
    cluster_profile: hypershift
    dependencies:
      OCP_IMAGE_N1: release:n1minor
      OCP_IMAGE_N2: release:n2minor
    env:
      ENABLE_HYPERSHIFT_CERT_ROTATION_SCALE: "true"
      REQUEST_SERVING_COMPONENT_TEST: "true"
    workflow: hypershift-aws-e2e-external