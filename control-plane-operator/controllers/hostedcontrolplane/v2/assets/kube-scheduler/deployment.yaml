apiVersion: apps/v1
kind: Deployment
metadata:
  name: kube-scheduler
spec:
  revisionHistoryLimit: 2
  selector:
    matchLabels:
      app: kube-scheduler
  strategy:
    rollingUpdate:
      maxSurge: 3
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: kube-scheduler
    spec:
      containers:
      - args:
        - --config=/etc/kubernetes/config/config.json
        - --cert-dir=/var/run/kubernetes
        - --tls-cert-file=/etc/kubernetes/certs/server/tls.crt
        - --tls-private-key-file=/etc/kubernetes/certs/server/tls.key
        - --secure-port=10259
        - --authentication-kubeconfig=/etc/kubernetes/kubeconfig/kubeconfig
        - --authorization-kubeconfig=/etc/kubernetes/kubeconfig/kubeconfig
        - -v=2
        command:
        - hyperkube
        - kube-scheduler
        image: hyperkube
        imagePullPolicy: IfNotPresent
        ports:
          - containerPort: 10259
            name: client
            protocol: TCP
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: 10259
            scheme: HTTPS
          initialDelaySeconds: 60
          periodSeconds: 60
          successThreshold: 1
          timeoutSeconds: 5
        name: kube-scheduler
        resources:
          requests:
            cpu: 25m
            memory: 150Mi
        volumeMounts:
        - mountPath: /etc/kubernetes/kubeconfig
          name: kubeconfig
        - mountPath: /etc/kubernetes/config
          name: scheduler-config
        - mountPath: /etc/kubernetes/certs/root-ca
          name: root-ca
        - mountPath: /etc/kubernetes/certs/server
          name: server-crt
      volumes:
      - name: cluster-signer
        secret:
          defaultMode: 416
          secretName: cluster-signer-ca
      - configMap:
          defaultMode: 420
          name: root-ca
        name: root-ca
      - name: service-signer
        secret:
          defaultMode: 416
          secretName: sa-signing-key
      - name: server-crt
        secret:
          defaultMode: 416
          secretName: kube-scheduler-server
      - configMap:
          defaultMode: 420
          name: kube-scheduler
        name: scheduler-config
      - name: kubeconfig
        secret:
          defaultMode: 416
          secretName: kube-scheduler-kubeconfig
